"use strict";(self.webpackChunkcaelis_terra=self.webpackChunkcaelis_terra||[]).push([[5721],{2866:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>h,data:()=>l});var n=a(6254);const t={},h=(0,a(6995).A)(t,[["render",function(i,s){return(0,n.uX)(),(0,n.CE)("div",null,s[0]||(s[0]=[(0,n.Fv)('<h1 id="fixture-å‰¯ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#fixture-å‰¯ä½œç”¨"><span>Fixture å‰¯ä½œç”¨</span></a></h1><h3 id="ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å…-fixture-å‰¯ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å…-fixture-å‰¯ä½œç”¨"><span><strong>ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å… Fixture å‰¯ä½œç”¨ï¼Ÿ</strong></span></a></h3><p><strong>å‰¯ä½œç”¨ï¼ˆSide Effectsï¼‰</strong> æŒ‡ Fixture åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ <strong>æ„å¤–ä¿®æ”¹äº†å…±äº«èµ„æºçš„çŠ¶æ€</strong>ï¼Œå¯¼è‡´ï¼š</p><ul><li><strong>æµ‹è¯•æ±¡æŸ“</strong>ï¼šæµ‹è¯• A ä¿®æ”¹äº†èµ„æºï¼Œå½±å“æµ‹è¯• B çš„ç»“æœ</li><li><strong>éšæœºå¤±è´¥</strong>ï¼šæµ‹è¯•æ‰§è¡Œé¡ºåºä¸åŒå¯¼è‡´ç»“æœä¸ç¨³å®š</li><li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šé—®é¢˜éš¾ä»¥å¤ç°ï¼Œå°¤å…¶æ˜¯å¹¶è¡Œæµ‹è¯•æ—¶</li></ul><hr><h3 id="äºŒã€scope-session-çš„æ— çŠ¶æ€è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#äºŒã€scope-session-çš„æ— çŠ¶æ€è®¾è®¡"><span><strong>äºŒã€<code>scope=&quot;session&quot;</code> çš„æ— çŠ¶æ€è®¾è®¡</strong></span></a></h3><h4 id="_1-æ— çŠ¶æ€-fixture-çš„å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-æ— çŠ¶æ€-fixture-çš„å®šä¹‰"><span><strong>1. æ— çŠ¶æ€ Fixture çš„å®šä¹‰</strong></span></a></h4><ul><li><strong>ä¸å­˜å‚¨å¯å˜æ•°æ®</strong>ï¼šSession çº§ Fixture åº”ä½œä¸º <strong>åªè¯»é…ç½®</strong> æˆ– <strong>ä¸å¯å˜èµ„æº</strong></li><li><strong>å¯é‡å¤ä½¿ç”¨</strong>ï¼šå¤šæ¬¡è°ƒç”¨ Fixture ä¸ä¼šæ”¹å˜å…¶è¡Œä¸ºæˆ–è¾“å‡º</li></ul><h4 id="_2-é”™è¯¯ç¤ºä¾‹-æœ‰çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_2-é”™è¯¯ç¤ºä¾‹-æœ‰çŠ¶æ€"><span><strong>2. é”™è¯¯ç¤ºä¾‹ï¼ˆæœ‰çŠ¶æ€ï¼‰</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> counter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;count&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¯å˜å­—å…¸ï¼Œå¯¼è‡´çŠ¶æ€æ®‹ç•™</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">counter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    counter[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;count&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> counter[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;count&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # é€šè¿‡</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">counter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    counter[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;count&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> counter[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;count&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # é€šè¿‡ï¼Œä½†ä¾èµ– test_a å…ˆæ‰§è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-æ­£ç¡®åšæ³•-æ— çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_3-æ­£ç¡®åšæ³•-æ— çŠ¶æ€"><span><strong>3. æ­£ç¡®åšæ³•ï¼ˆæ— çŠ¶æ€ï¼‰</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> initial_count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è¿”å›ä¸å¯å˜å€¼</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">initial_count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    current </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> initial_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> current </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # ç‹¬ç«‹è®¡ç®—ï¼Œä¸ä¿®æ”¹åŸå§‹å€¼</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">initial_count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    current </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> initial_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> current </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # å§‹ç»ˆä¸º1ï¼Œä¸å—å…¶ä»–æµ‹è¯•å½±å“</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="ä¸‰ã€å¤„ç†å¯å˜èµ„æºçš„ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€å¤„ç†å¯å˜èµ„æºçš„ç­–ç•¥"><span><strong>ä¸‰ã€å¤„ç†å¯å˜èµ„æºçš„ç­–ç•¥</strong></span></a></h3><h4 id="_1-èµ„æºåŠ é”" tabindex="-1"><a class="header-anchor" href="#_1-èµ„æºåŠ é”"><span><strong>1. èµ„æºåŠ é”</strong></span></a></h4><p>å½“å¤šä¸ªæµ‹è¯•è¿›ç¨‹/çº¿ç¨‹å¿…é¡»è®¿é—®åŒä¸€èµ„æºï¼ˆå¦‚æ–‡ä»¶ã€æ•°æ®åº“ï¼‰æ—¶ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> filelock</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> shared_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">tmp_path_factory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    file_path </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tmp_path_factory.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">getbasetemp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;shared.log&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    lock </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> filelock.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">FileLock</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file_path.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">with_suffix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;.lock&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> lock:  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åŠ é”ç¡®ä¿åŸå­æ“ä½œ</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        with</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file_path, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> f:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            f.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;initialized</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    yield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> file_path</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> lock:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        os.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">remove</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file_path)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®‰å…¨æ¸…ç†</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-èµ„æºéš”ç¦»" tabindex="-1"><a class="header-anchor" href="#_2-èµ„æºéš”ç¦»"><span><strong>2. èµ„æºéš”ç¦»</strong></span></a></h4><p>ä¸ºæ¯ä¸ªæµ‹è¯•ç”Ÿæˆå”¯ä¸€èµ„æºå®ä¾‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> temp_db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">database</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># database æ˜¯ session çº§è¿æ¥æ± </span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ä»è¿æ¥æ± è·å–ç‹¬ç«‹è¿æ¥</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    conn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> database.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get_connection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    yield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> conn</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æµ‹è¯•ç»“æŸåå½’è¿˜è¿æ¥ï¼Œä¸ä¿®æ”¹è¿æ¥æ± çŠ¶æ€</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    conn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rollback</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    database.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">release_connection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(conn)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-æ·±æ‹·è´å¯å˜å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3-æ·±æ‹·è´å¯å˜å¯¹è±¡"><span><strong>3. æ·±æ‹·è´å¯å˜å¯¹è±¡</strong></span></a></h4><p>é˜²æ­¢å…±äº«å¯¹è±¡è¢«æ„å¤–ä¿®æ”¹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> copy</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">default_config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># default_config æ˜¯ session çº§ Fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> copy.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">deepcopy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(default_config)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›æ·±æ‹·è´å‰¯æœ¬</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_config_update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    config[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;timeout&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # ä¿®æ”¹ä¸å½±å“å…¶ä»–æµ‹è¯•</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> config[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;timeout&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="å››ã€å¹¶è¡Œæµ‹è¯•ä¸‹çš„é˜²æŠ¤" tabindex="-1"><a class="header-anchor" href="#å››ã€å¹¶è¡Œæµ‹è¯•ä¸‹çš„é˜²æŠ¤"><span><strong>å››ã€å¹¶è¡Œæµ‹è¯•ä¸‹çš„é˜²æŠ¤</strong></span></a></h3><p>ä½¿ç”¨ <strong><code>pytest-xdist</code></strong> å¹¶è¡Œæ‰§è¡Œæ—¶ï¼Œéœ€é¢å¤–æ³¨æ„èµ„æºç«äº‰ï¼š</p><h4 id="_1-è¿›ç¨‹çº§éš”ç¦»" tabindex="-1"><a class="header-anchor" href="#_1-è¿›ç¨‹çº§éš”ç¦»"><span><strong>1. è¿›ç¨‹çº§éš”ç¦»</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> session_tmp_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">tmp_path_factory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tmp_path_factory.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">mktemp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¯ä¸ªè¿›ç¨‹åˆ›å»ºç‹¬ç«‹ç›®å½•</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">session_tmp_dir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> session_tmp_dir </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;test.txt&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è¿›ç¨‹å†…å”¯ä¸€</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-æ•°æ®åº“äº‹åŠ¡å›æ»š" tabindex="-1"><a class="header-anchor" href="#_2-æ•°æ®åº“äº‹åŠ¡å›æ»š"><span><strong>2. æ•°æ®åº“äº‹åŠ¡å›æ»š</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> db_transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">database</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    conn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> database.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">begin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¼€å¯äº‹åŠ¡</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    yield</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> conn</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    conn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rollback</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å›æ»šï¼Œç¡®ä¿æ•°æ®ä¸å˜</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="äº”ã€æœ€ä½³å®è·µæ€»ç»“" tabindex="-1"><a class="header-anchor" href="#äº”ã€æœ€ä½³å®è·µæ€»ç»“"><span><strong>äº”ã€æœ€ä½³å®è·µæ€»ç»“</strong></span></a></h3><table><thead><tr><th><strong>ç­–ç•¥</strong></th><th><strong>é€‚ç”¨åœºæ™¯</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td><strong>è¿”å›ä¸å¯å˜æ•°æ®</strong></td><td>é…ç½®å‚æ•°ã€å¸¸é‡</td><td>è¿”å›å…ƒç»„ä»£æ›¿åˆ—è¡¨</td></tr><tr><td><strong>èµ„æºæ± åŒ– + éš”ç¦»</strong></td><td>æ•°æ®åº“è¿æ¥ã€ç½‘ç»œä¼šè¯</td><td>æ¯ä¸ªæµ‹è¯•è·å–ç‹¬ç«‹è¿æ¥</td></tr><tr><td><strong>åŸå­æ“ä½œ + é”</strong></td><td>æ–‡ä»¶æ“ä½œã€å…±äº«å†…å­˜</td><td>ä½¿ç”¨ <code>filelock</code> åº“</td></tr><tr><td><strong>æ·±æ‹·è´</strong></td><td>å¤æ‚é…ç½®å¯¹è±¡</td><td><code>copy.deepcopy()</code></td></tr><tr><td><strong>äº‹åŠ¡å›æ»š</strong></td><td>æ•°æ®åº“æµ‹è¯•</td><td>æ¯ä¸ªæµ‹è¯•åœ¨ç‹¬ç«‹äº‹åŠ¡ä¸­æ‰§è¡Œå¹¶å›æ»š</td></tr></tbody></table><hr><h3 id="å…­ã€é”™è¯¯æ¨¡å¼ä¸ä¿®æ­£" tabindex="-1"><a class="header-anchor" href="#å…­ã€é”™è¯¯æ¨¡å¼ä¸ä¿®æ­£"><span><strong>å…­ã€é”™è¯¯æ¨¡å¼ä¸ä¿®æ­£</strong></span></a></h3><h4 id="é”™è¯¯-ç›´æ¥ä¿®æ”¹-session-çº§-fixture" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯-ç›´æ¥ä¿®æ”¹-session-çº§-fixture"><span><strong>é”™è¯¯ï¼šç›´æ¥ä¿®æ”¹ Session çº§ Fixture</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> global_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">global_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    global_data.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ±¡æŸ“å…¶ä»–æµ‹è¯•</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">global_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    assert</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(global_data) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # å¤±è´¥ï¼å®é™…ä¸º1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä¿®æ­£-é˜²å¾¡æ€§å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#ä¿®æ­£-é˜²å¾¡æ€§å¤åˆ¶"><span><strong>ä¿®æ­£ï¼šé˜²å¾¡æ€§å¤åˆ¶</strong></span></a></h4><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;session&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> global_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åŸºç¡€æ•°æ®</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">@pytest</span><span style="--shiki-light:#4078F2;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fixture</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> safe_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">global_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(global_data)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›å‰¯æœ¬</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test_a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">safe_data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    safe_data.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸å½±å“å…¶ä»–æµ‹è¯•</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="ä¸ƒã€æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ä¸ƒã€æ€»ç»“"><span><strong>ä¸ƒã€æ€»ç»“</strong></span></a></h3><ul><li><strong>Session çº§ Fixture</strong> å¿…é¡»è®¾è®¡ä¸º <strong>æ— çŠ¶æ€</strong> æˆ– <strong>åªè¯»</strong>ï¼Œé¿å…æˆä¸ºæµ‹è¯•æ±¡æŸ“çš„æºå¤´</li><li><strong>å¯å˜èµ„æº</strong> åº”é€šè¿‡ <strong>åŠ é”ã€éš”ç¦»ã€äº‹åŠ¡ç®¡ç†</strong> ç¡®ä¿çº¿ç¨‹/è¿›ç¨‹å®‰å…¨</li><li><strong>æ·±æ‹·è´</strong> å’Œ <strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong> æ˜¯é˜²æ­¢å‰¯ä½œç”¨çš„å…³é”®æŠ€å·§</li></ul><p>éµå¾ªè¿™äº›åŸåˆ™ï¼Œå¯å¤§å¹…æå‡æµ‹è¯•å¥—ä»¶çš„ <strong>ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§</strong>ï¼ ğŸ”’ğŸš€</p>',43)]))}]]),l=JSON.parse('{"path":"/auto/se/sundry/fixture_side_effects.html","title":"Fixture å‰¯ä½œç”¨","lang":"zh-CN","frontmatter":{"description":"Fixture å‰¯ä½œç”¨ ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å… Fixture å‰¯ä½œç”¨ï¼Ÿ å‰¯ä½œç”¨ï¼ˆSide Effectsï¼‰ æŒ‡ Fixture åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ æ„å¤–ä¿®æ”¹äº†å…±äº«èµ„æºçš„çŠ¶æ€ï¼Œå¯¼è‡´ï¼š æµ‹è¯•æ±¡æŸ“ï¼šæµ‹è¯• A ä¿®æ”¹äº†èµ„æºï¼Œå½±å“æµ‹è¯• B çš„ç»“æœ éšæœºå¤±è´¥ï¼šæµ‹è¯•æ‰§è¡Œé¡ºåºä¸åŒå¯¼è‡´ç»“æœä¸ç¨³å®š è°ƒè¯•å›°éš¾ï¼šé—®é¢˜éš¾ä»¥å¤ç°ï¼Œå°¤å…¶æ˜¯å¹¶è¡Œæµ‹è¯•æ—¶ äºŒã€scope=\\"session\\" çš„æ— çŠ¶...","head":[["meta",{"property":"og:url","content":"https://hekun97.github.io/auto/se/sundry/fixture_side_effects.html"}],["meta",{"property":"og:site_name","content":"ä¸“ä¸šæ²»å¤´ç§ƒ"}],["meta",{"property":"og:title","content":"Fixture å‰¯ä½œç”¨"}],["meta",{"property":"og:description","content":"Fixture å‰¯ä½œç”¨ ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å… Fixture å‰¯ä½œç”¨ï¼Ÿ å‰¯ä½œç”¨ï¼ˆSide Effectsï¼‰ æŒ‡ Fixture åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ æ„å¤–ä¿®æ”¹äº†å…±äº«èµ„æºçš„çŠ¶æ€ï¼Œå¯¼è‡´ï¼š æµ‹è¯•æ±¡æŸ“ï¼šæµ‹è¯• A ä¿®æ”¹äº†èµ„æºï¼Œå½±å“æµ‹è¯• B çš„ç»“æœ éšæœºå¤±è´¥ï¼šæµ‹è¯•æ‰§è¡Œé¡ºåºä¸åŒå¯¼è‡´ç»“æœä¸ç¨³å®š è°ƒè¯•å›°éš¾ï¼šé—®é¢˜éš¾ä»¥å¤ç°ï¼Œå°¤å…¶æ˜¯å¹¶è¡Œæµ‹è¯•æ—¶ äºŒã€scope=\\"session\\" çš„æ— çŠ¶..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-11T16:29:43.000Z"}],["meta",{"property":"article:modified_time","content":"2025-03-11T16:29:43.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Fixture å‰¯ä½œç”¨\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-03-11T16:29:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ä¸“ä¸šæ²»å¤´ç§ƒ\\",\\"url\\":\\"https://github.com/hekun97\\"}]}"]]},"git":{"createdTime":1741624426000,"updatedTime":1741710583000,"contributors":[{"name":"hekun97","username":"hekun97","email":"hek97@qq.com","commits":2,"url":"https://github.com/hekun97"}]},"readingTime":{"minutes":2.95,"words":886},"filePathRelative":"auto/se/sundry/fixture_side_effects.md","localizedDate":"2025å¹´3æœˆ10æ—¥","excerpt":"\\n<h3><strong>ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦é¿å… Fixture å‰¯ä½œç”¨ï¼Ÿ</strong></h3>\\n<p><strong>å‰¯ä½œç”¨ï¼ˆSide Effectsï¼‰</strong> æŒ‡ Fixture åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ <strong>æ„å¤–ä¿®æ”¹äº†å…±äº«èµ„æºçš„çŠ¶æ€</strong>ï¼Œå¯¼è‡´ï¼š</p>\\n<ul>\\n<li><strong>æµ‹è¯•æ±¡æŸ“</strong>ï¼šæµ‹è¯• A ä¿®æ”¹äº†èµ„æºï¼Œå½±å“æµ‹è¯• B çš„ç»“æœ</li>\\n<li><strong>éšæœºå¤±è´¥</strong>ï¼šæµ‹è¯•æ‰§è¡Œé¡ºåºä¸åŒå¯¼è‡´ç»“æœä¸ç¨³å®š</li>\\n<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šé—®é¢˜éš¾ä»¥å¤ç°ï¼Œå°¤å…¶æ˜¯å¹¶è¡Œæµ‹è¯•æ—¶</li>\\n</ul>","autoDesc":true}')},6995:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,n]of s)a[i]=n;return a}}}]);