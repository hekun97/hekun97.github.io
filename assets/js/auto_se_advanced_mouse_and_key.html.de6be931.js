"use strict";(self.webpackChunkcaelis_terra=self.webpackChunkcaelis_terra||[]).push([[8593],{6995:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,n]of i)a[s]=n;return a}},7159:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>e,data:()=>h});var n=a(6254);const t={},e=(0,a(6995).A)(t,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<p>以下是 <strong>Selenium 中鼠标和键盘操作</strong> 的详细指南，涵盖常见场景、代码示例及最佳实践：</p><hr><h1 id="鼠标和键盘操作" tabindex="-1"><a class="header-anchor" href="#鼠标和键盘操作"><span>鼠标和键盘操作</span></a></h1><p>Selenium 通过 <code>ActionChains</code> 类模拟复杂的用户交互（鼠标、键盘、触控），需导入：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> selenium.webdriver.common.action_chains </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ActionChains</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="一、鼠标操作" tabindex="-1"><a class="header-anchor" href="#一、鼠标操作"><span><strong>一、鼠标操作</strong></span></a></h2><h3 id="_1-基础操作" tabindex="-1"><a class="header-anchor" href="#_1-基础操作"><span><strong>1. 基础操作</strong></span></a></h3><table><thead><tr><th><strong>方法</strong></th><th><strong>说明</strong></th><th><strong>代码示例</strong></th></tr></thead><tbody><tr><td><strong>点击</strong></td><td>左键/右键/双击</td><td><code>click(element)</code> / <code>context_click(element)</code> / <code>double_click(element)</code></td></tr><tr><td><strong>悬停（Hover）</strong></td><td>鼠标移动到元素上方，模拟鼠标悬停效果</td><td><code>move_to_element(element)</code></td></tr><tr><td><strong>拖放</strong></td><td>拖动元素到目标位置，模拟鼠标拖动效果</td><td><code>drag_and_drop(source, target)</code></td></tr><tr><td><strong>偏移移动</strong></td><td>基于当前位置相对移动</td><td><code>move_by_offset(x, y)</code></td></tr></tbody></table><h3 id="_2-示例代码" tabindex="-1"><a class="header-anchor" href="#_2-示例代码"><span><strong>2. 示例代码</strong></span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 实例化ActionChains()对象</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> ActionChains</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(driver)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 悬停后右键点击菜单项</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_to_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(menu).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">context_click</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拖放文件到上传区域</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">drag_and_drop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file_element, upload_area).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 精确控制偏移（从元素中心偏移50px右，30px下）</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_to_element_with_offset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(element, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p><code>perform()</code>用来执行鼠标操作。</p></div><h3 id="_3-高级操作" tabindex="-1"><a class="header-anchor" href="#_3-高级操作"><span><strong>3. 高级操作</strong></span></a></h3><ul><li><p><strong>组合操作</strong>：链式调用多个动作后执行 <code>perform()</code>。</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 按住滑块slider（不释放） → 向右拖动 100px → 释放</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click_and_hold</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(slider)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_by_offset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">release</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>画笔轨迹模拟</strong>（自动化绘图场景）：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 移动到canvas到元素上方 → 按住不释放 → 向右上拖动 → 向左上拖动 → 释放</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_to_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(canvas)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click_and_hold</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_by_offset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_by_offset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">release</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="二、键盘操作" tabindex="-1"><a class="header-anchor" href="#二、键盘操作"><span><strong>二、键盘操作</strong></span></a></h2><h3 id="_1-基础方法" tabindex="-1"><a class="header-anchor" href="#_1-基础方法"><span><strong>1. 基础方法</strong></span></a></h3><table><thead><tr><th><strong>方法</strong></th><th><strong>说明</strong></th><th><strong>代码示例</strong></th></tr></thead><tbody><tr><td><strong>按键发送</strong></td><td>向焦点元素发送按键</td><td><code>send_keys(&quot;text&quot;)</code></td></tr><tr><td><strong>组合键</strong></td><td>如 Ctrl+C / Alt+Tab</td><td><code>key_down(Keys.CONTROL).send_keys(&quot;c&quot;).key_up(Keys.CONTROL)</code></td></tr><tr><td><strong>释放按键</strong></td><td>松开已按下的键</td><td><code>key_up(Keys.SHIFT)</code></td></tr></tbody></table><div class="hint-container warning"><p class="hint-container-title">注意</p><p><code>send_keys(Keys.CONTROL, &#39;c&#39;)</code> 和 <code>key_down(Keys.CONTROL).send_keys(&quot;c&quot;).key_up(Keys.CONTROL)</code> <strong>看似功能相同</strong>，但底层行为存在关键差异。推荐<strong>显式修饰键控制</strong>。</p><table><thead><tr><th style="text-align:center;"><strong>方法</strong></th><th style="text-align:center;"><strong>底层行为</strong></th><th style="text-align:center;"><strong>适用场景</strong></th></tr></thead><tbody><tr><td style="text-align:center;"><code>send_keys(Keys.CONTROL, &#39;c&#39;)</code></td><td style="text-align:center;"><strong>同时按下并释放</strong>所有键（<code>CONTROL</code> + <code>c</code> 的瞬时组合）</td><td style="text-align:center;">简单组合键操作（非严格依赖顺序）</td></tr><tr><td style="text-align:center;"><code>key_down(Keys.CONTROL).send_keys(&quot;c&quot;).key_up(Keys.CONTROL)</code></td><td style="text-align:center;"><strong>显式控制修饰键状态</strong>：按下 <code>CONTROL</code> → 按 <code>c</code> → 释放 <code>c</code> → 释放 <code>CONTROL</code></td><td style="text-align:center;">严格模拟用户操作或跨平台需求</td></tr></tbody></table></div><h3 id="_2-示例代码-1" tabindex="-1"><a class="header-anchor" href="#_2-示例代码-1"><span><strong>2. 示例代码</strong></span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> selenium.webdriver.common.keys </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Keys</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 输入文本并回车</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;搜索内容&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTER</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 复制粘贴操作</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_down</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;c&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_up</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">TAB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_down</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;v&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-特殊按键列表" tabindex="-1"><a class="header-anchor" href="#_3-特殊按键列表"><span><strong>3. 特殊按键列表</strong></span></a></h3><table><thead><tr><th><strong>按键常量</strong></th><th><strong>对应键位</strong></th></tr></thead><tbody><tr><td><code>Keys.ENTER</code></td><td>回车</td></tr><tr><td><code>Keys.BACK_SPACE</code></td><td>退格</td></tr><tr><td><code>Keys.SHIFT</code> / <code>Keys.CONTROL</code></td><td>修饰键</td></tr><tr><td><code>Keys.ARROW_LEFT</code></td><td>方向键左</td></tr><tr><td><code>Keys.F5</code></td><td>刷新键</td></tr></tbody></table><hr><h2 id="三、实战场景" tabindex="-1"><a class="header-anchor" href="#三、实战场景"><span><strong>三、实战场景</strong></span></a></h2><h3 id="场景-1-滑动验证码" tabindex="-1"><a class="header-anchor" href="#场景-1-滑动验证码"><span><strong>场景 1：滑动验证码</strong></span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">slider </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> driver.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">find_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(By.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;slider&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">track </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> driver.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">find_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(By.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;track&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 按住元素slider并不释放 → 悬停到元素track上 → 向右拖动300px → 释放</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click_and_hold</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(slider)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_to_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(track)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">move_by_offset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">release</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="场景-2-快捷键保存网页" tabindex="-1"><a class="header-anchor" href="#场景-2-快捷键保存网页"><span><strong>场景 2：快捷键保存网页</strong></span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 按下 CTRL + S 并释放</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_down</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">send_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;s&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_up</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 处理保存弹窗（需切换至系统弹窗，可能需用AutoIT/Pyautogui）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="场景-3-多选列表项" tabindex="-1"><a class="header-anchor" href="#场景-3-多选列表项"><span><strong>场景 3：多选列表项</strong></span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">item1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> driver.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">find_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(By.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;item1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">item2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> driver.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">find_element</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(By.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;item2&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过CTRL多选列表项 item1、item2</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">actions.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_down</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(item1)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">click</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(item2)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">key_up</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Keys.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CONTROL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)\\</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       .</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">perform</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="四、注意事项" tabindex="-1"><a class="header-anchor" href="#四、注意事项"><span><strong>四、注意事项</strong></span></a></h2><ol><li><strong>执行动作</strong>：所有操作需以 <code>perform()</code> 结尾才会生效。</li><li><strong>焦点控制</strong>：键盘操作前确保目标元素已获得焦点（可先点击元素）。</li><li><strong>跨平台差异</strong>：组合键行为可能因操作系统不同而变化（如 Mac 的 <code>Command</code> vs Windows 的 <code>Control</code>）。</li><li><strong>性能优化</strong>：减少不必要的连续操作，合并动作为单个 <code>perform()</code> 调用。</li></ol><hr><h2 id="五、常见问题排查" tabindex="-1"><a class="header-anchor" href="#五、常见问题排查"><span><strong>五、常见问题排查</strong></span></a></h2><table><thead><tr><th><strong>问题</strong></th><th><strong>解决方案</strong></th></tr></thead><tbody><tr><td>操作未生效</td><td>检查是否遗漏 <code>perform()</code> 或元素未正确聚焦</td></tr><tr><td>拖放失效</td><td>使用 <code>move_by_offset</code> 替代 <code>drag_and_drop</code></td></tr><tr><td>弹窗阻断操作</td><td>先处理弹窗（<code>switch_to.alert</code>）</td></tr><tr><td>浏览器兼容性问题</td><td>更新浏览器驱动至最新版本</td></tr></tbody></table><hr><h2 id="六、最佳实践" tabindex="-1"><a class="header-anchor" href="#六、最佳实践"><span><strong>六、最佳实践</strong></span></a></h2><ul><li><strong>优先使用简单方法</strong>：如元素自带的 <code>click()</code> 或 <code>send_keys()</code>，仅在复杂交互时使用 <code>ActionChains</code>。</li><li><strong>显式等待就绪</strong>：操作前确保元素可交互（结合 <code>WebDriverWait</code>）。</li><li><strong>封装复用</strong>：将常用操作（如文件上传）封装为工具函数。</li></ul><p>掌握这些技巧，可轻松应对 90% 的 Web 自动化交互需求！ 🚀</p>',41)]))}]]),h=JSON.parse('{"path":"/auto/se/advanced/mouse_and_key.html","title":"鼠标和键盘操作","lang":"zh-CN","frontmatter":{"description":"以下是 Selenium 中鼠标和键盘操作 的详细指南，涵盖常见场景、代码示例及最佳实践： 鼠标和键盘操作 Selenium 通过 ActionChains 类模拟复杂的用户交互（鼠标、键盘、触控），需导入： 一、鼠标操作 1. 基础操作 2. 示例代码 相关信息 perform()用来执行鼠标操作。 3. 高级操作 组合操作：链式调用多个动作后执行 ...","head":[["meta",{"property":"og:url","content":"https://hekun97.github.io/auto/se/advanced/mouse_and_key.html"}],["meta",{"property":"og:site_name","content":"专业治头秃"}],["meta",{"property":"og:title","content":"鼠标和键盘操作"}],["meta",{"property":"og:description","content":"以下是 Selenium 中鼠标和键盘操作 的详细指南，涵盖常见场景、代码示例及最佳实践： 鼠标和键盘操作 Selenium 通过 ActionChains 类模拟复杂的用户交互（鼠标、键盘、触控），需导入： 一、鼠标操作 1. 基础操作 2. 示例代码 相关信息 perform()用来执行鼠标操作。 3. 高级操作 组合操作：链式调用多个动作后执行 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-10T16:33:46.000Z"}],["meta",{"property":"article:modified_time","content":"2025-03-10T16:33:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"鼠标和键盘操作\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-03-10T16:33:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"专业治头秃\\",\\"url\\":\\"https://github.com/hekun97\\"}]}"]]},"git":{"createdTime":1741624426000,"updatedTime":1741624426000,"contributors":[{"name":"hekun97","username":"hekun97","email":"hek97@qq.com","commits":1,"url":"https://github.com/hekun97"}]},"readingTime":{"minutes":3.35,"words":1006},"filePathRelative":"auto/se/advanced/mouse_and_key.md","localizedDate":"2025年3月10日","excerpt":"<p>以下是 <strong>Selenium 中鼠标和键盘操作</strong> 的详细指南，涵盖常见场景、代码示例及最佳实践：</p>\\n<hr>\\n<h1>鼠标和键盘操作</h1>\\n<p>Selenium 通过 <code>ActionChains</code> 类模拟复杂的用户交互（鼠标、键盘、触控），需导入：</p>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"python\\" data-title=\\"python\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">from</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> selenium.webdriver.common.action_chains </span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">import</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> ActionChains</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);